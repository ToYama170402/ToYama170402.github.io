+++
title = 'マイクラサーバーを立ててみた'
date = 2025-12-04T00:00:00+09:00
categories = ["ポエム","経験談","技術"]
draft = false
+++

# マイクラサーバーを立ててみた

この記事は[金沢IT部活 Advent Calendar 2025](https://qiita.com/advent-calendar/2025/kanazawa-itbukatsu)の4日目の記事になります。3日の記事は[りくと](https://qiita.com/rikut0904)さんの[オペレーティングシステムの勉強2-Linuxについて](https://qiita.com/rikut0904/items/5171e8ccea1a14833b37)でした。

バイトに向かう送迎車の中からおはようございます。唐突に生えたIT部活のアドカレを期に、溜まっていたネタを順々に放出できたらなと思います。

今回は身内向けにマイクラサーバーを構築した話から、構成やこだわりポイントなどを紹介していきます。マイクラサーバーの運営や監視周りは初めてで、AIと話しながら調べながらでやっていますので、生暖かい目で見ていってください。

## サーバーの構成

- Cloudflare Tunnel
- [Proxmox](https://proxmox.com/en/) (仮想化基盤)
- Docker
  - マイクラサーバー
    - DiscordSRV (Discord連携)
    - ViaVersion (新しいクライアントで古いサーバーに接続できるようにするプラグイン)
    - ViaBackwards (古いクライアントで新しいサーバーに接続できるようにするプラグイン)
  - Bluemap (マイクラワールドマップツール)
  - Prometheus (監視基盤用時系列データベース)
  - Grafana (監視基盤ダッシュボード)

自宅の回線の都合で、ポートを開放して外部からアクセスすることができないのでCloudflare Tunnelを使っています。

DockerはProxmoxのKVMのマシン上で動作しています。Cloudflare Tunnelにトンネルを作るcloudflaredはProxmox上のLXCで動作しています。[cloudflaredはDockerでも動きますが](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/downloads/)、DockerのKVMが倒れるとcloudflaredも巻き添えを食らってめんどくさいことになりそうだったので、分離してみています(この判断がいいのか悪いのかはわからないけど…)。

効果的なリソース配分や運用を楽しくするために、メトリクスの監視を手探りでやっています。やっぱりああいうダッシュボードってカッコいいよね。

// TODO: この辺にアーキテクチャ図を載せたい

## マイクラサーバーをDockerで立てるには

今回Dockerを使ってマイクラサーバーを構築したのですけど、思っていた以上に体験が良かったです。

僕の周りだと、やれビルドが面倒だの、やれJavaのバージョンが合わないだの、やれプラグインのバージョンが合わないだの、めんどくさいという文句をよく聞きました。しかしDockerイメージがよくできていたのでそのへんの不便さが払拭されていました。

### プラグイン

## 監視システム

## まとめ

